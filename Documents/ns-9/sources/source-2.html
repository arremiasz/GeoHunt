


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > PowerupController</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.geohunt.backend.powerup</a>
</div>

<h1>Coverage Summary for Class: PowerupController (com.geohunt.backend.powerup)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">PowerupController</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    9.1%
  </span>
  <span class="absValue">
    (1/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    9.1%
  </span>
  <span class="absValue">
    (1/11)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.geohunt.backend.powerup;
&nbsp;
&nbsp;import com.geohunt.backend.util.Location;
&nbsp;import io.swagger.v3.oas.annotations.Operation;
&nbsp;import io.swagger.v3.oas.annotations.Parameter;
&nbsp;import io.swagger.v3.oas.annotations.media.Content;
&nbsp;import io.swagger.v3.oas.annotations.media.ExampleObject;
&nbsp;import io.swagger.v3.oas.annotations.media.Schema;
&nbsp;import io.swagger.v3.oas.annotations.responses.ApiResponse;
&nbsp;import io.swagger.v3.oas.annotations.responses.ApiResponses;
&nbsp;import io.swagger.v3.oas.annotations.tags.Tag;
&nbsp;import org.springframework.beans.factory.annotation.Autowired;
&nbsp;import org.springframework.http.ResponseEntity;
&nbsp;import org.springframework.web.bind.annotation.*;
&nbsp;
&nbsp;@Tag(
&nbsp;        name = &quot;Powerups&quot;,
&nbsp;        description = &quot;Operations related to creating, deleting, generating, and applying powerups in the game.&quot;
&nbsp;)
&nbsp;@RestController
&nbsp;@RequestMapping(&quot;/powerup&quot;)
<b class="fc">&nbsp;public class PowerupController {</b>
&nbsp;
&nbsp;    @Autowired
&nbsp;    private PowerupService service;
&nbsp;
&nbsp;    // ========================================================================
&nbsp;    // DEVELOPMENT-ONLY ENDPOINTS (DIRECT DB INTERACTION)
&nbsp;    // ========================================================================
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Add a new powerup (DEV ONLY)&quot;,
&nbsp;            description = &quot;Creates a new powerup entry in the database. Intended for development/testing only.&quot;
&nbsp;    )
&nbsp;    @ApiResponses({
&nbsp;            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;returns powerup id&quot;,
&nbsp;                    content = @Content(mediaType = &quot;application/json&quot;,
&nbsp;                            schema = @Schema(implementation = Powerup.class))),
&nbsp;            @ApiResponse(responseCode = &quot;400&quot;, description = &quot;Invalid powerup data&quot;, content = @Content)
&nbsp;    })
&nbsp;    @io.swagger.v3.oas.annotations.parameters.RequestBody(
&nbsp;            description = &quot;Powerup object with name, affect text, and type. Some already implemented. Please ask before adding your own.&quot;,
&nbsp;            required = true,
&nbsp;            content = @Content(
&nbsp;                    schema = @Schema(implementation = Powerup.class),
&nbsp;                    examples = @ExampleObject(
&nbsp;                            value = &quot;&quot;&quot;
&nbsp;                            {
&nbsp;                              &quot;name&quot;: &quot;Give a hint of the general location&quot;,
&nbsp;                              &quot;affect&quot;: &quot;General hint for the challenge&quot;,
&nbsp;                              &quot;type&quot;: &quot;LOCATION_HINT_GENERAL&quot;
&nbsp;                            }
&nbsp;                            &quot;&quot;&quot;
&nbsp;                    )
&nbsp;            )
&nbsp;    )
&nbsp;    @PostMapping
&nbsp;    public ResponseEntity addPowerup(@RequestBody Powerup powerup) {
<b class="nc">&nbsp;        return service.add(powerup);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Delete a powerup by ID (DEV ONLY)&quot;,
&nbsp;            description = &quot;Removes a powerup entry from the database. Intended for development/testing only.&quot;
&nbsp;    )
&nbsp;    @ApiResponses({
&nbsp;            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Powerup deleted successfully&quot;),
&nbsp;            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Powerup not found&quot;)
&nbsp;    })
&nbsp;    @DeleteMapping
&nbsp;    public ResponseEntity removePowerup(
&nbsp;            @Parameter(description = &quot;Powerup ID&quot;) @RequestParam long id) {
<b class="nc">&nbsp;        return service.delete(id);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Find a powerup by ID&quot;,
&nbsp;            description = &quot;Fetches information about a specific powerup.&quot;
&nbsp;    )
&nbsp;    @ApiResponses({
&nbsp;            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Powerup found&quot;,
&nbsp;                    content = @Content(schema = @Schema(implementation = Powerup.class))),
&nbsp;            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Powerup not found&quot;)
&nbsp;    })
&nbsp;    @GetMapping(&quot;/id&quot;)
&nbsp;    public ResponseEntity findById(
&nbsp;            @Parameter(description = &quot;Powerup ID&quot;) @RequestParam long id) {
<b class="nc">&nbsp;        return service.get(id);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Find a powerup by name&quot;,
&nbsp;            description = &quot;Search the database for a powerup with the given name.&quot;
&nbsp;    )
&nbsp;    @ApiResponses({
&nbsp;            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Powerup found&quot;,
&nbsp;                    content = @Content(schema = @Schema(implementation = Powerup.class))),
&nbsp;            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Powerup not found&quot;)
&nbsp;    })
&nbsp;    @GetMapping(&quot;/name&quot;)
&nbsp;    public ResponseEntity findByName(
&nbsp;            @Parameter(description = &quot;Powerup name&quot;) @RequestParam String name) {
<b class="nc">&nbsp;        return service.get(name);</b>
&nbsp;    }
&nbsp;
&nbsp;    // ========================================================================
&nbsp;    // IN-GAME ENDPOINTS (USED BY THE MOBILE CLIENT)
&nbsp;    // ========================================================================
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Generate a random powerup near the player&#39;s route&quot;,
&nbsp;            description = &quot;&quot;&quot;
&nbsp;                    Generates a powerup between the user&#39;s starting location and the challenge&#39;s end location,
&nbsp;                    with a perpendicular offset determined by distance-based math. Returns the powerup type 
&nbsp;                    and coordinates where the powerup should spawn.
&nbsp;                    &quot;&quot;&quot;
&nbsp;    )
&nbsp;    @ApiResponses({
&nbsp;            @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Powerup successfully generated&quot;,
&nbsp;                    content = @Content(schema = @Schema(implementation = RandomGenerationDTO.class))),
&nbsp;            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Challenge not found&quot;)
&nbsp;    })
&nbsp;    @io.swagger.v3.oas.annotations.parameters.RequestBody(
&nbsp;            required = true,
&nbsp;            description = &quot;The player&#39;s current GPS location.&quot;,
&nbsp;            content = @Content(
&nbsp;                    schema = @Schema(implementation = Location.class),
&nbsp;                    examples = @ExampleObject(
&nbsp;                            value = &quot;&quot;&quot;
&nbsp;                            {
&nbsp;                              &quot;latitude&quot;: 42.03386,
&nbsp;                              &quot;longitude&quot;: -93.642763
&nbsp;                            }
&nbsp;                            &quot;&quot;&quot;
&nbsp;                    )
&nbsp;            )
&nbsp;    )
&nbsp;    @PostMapping(&quot;/generate&quot;)
&nbsp;    public ResponseEntity challenge(
&nbsp;            @Parameter(description = &quot;Challenge ID&quot;) @RequestParam long chalid,
&nbsp;            @RequestBody Location loc) {
<b class="nc">&nbsp;        return service.generate(chalid, loc);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Generate a deterministic powerup location&quot;,
&nbsp;            description = &quot;Creates a powerup spawn point between the player&#39;s current location and the challenge goal. &quot; +
&nbsp;                    &quot;This endpoint uses a specific powerup ID instead of picking one randomly.&quot;,
&nbsp;            requestBody = @io.swagger.v3.oas.annotations.parameters.RequestBody(
&nbsp;                    description = &quot;Player&#39;s current GPS location&quot;,
&nbsp;                    required = true,
&nbsp;                    content = @Content(
&nbsp;                            schema = @Schema(implementation = Location.class),
&nbsp;                            examples = @ExampleObject(
&nbsp;                                    name = &quot;PlayerLocationExample&quot;,
&nbsp;                                    description = &quot;Example player location&quot;,
&nbsp;                                    value = &quot;{\&quot;latitude\&quot;: 42.03386, \&quot;longitude\&quot;: -93.642763}\&quot;&quot;
&nbsp;                            )
&nbsp;                    )
&nbsp;            )
&nbsp;    )
&nbsp;    @ApiResponses(value = {
&nbsp;            @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Deterministic powerup generated&quot;,
&nbsp;                    content = @Content(mediaType = &quot;application/json&quot;,
&nbsp;                            schema = @Schema(implementation = RandomGenerationDTO.class))),
&nbsp;            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Powerup or Challenge not found&quot;, content = @Content)
&nbsp;    })
&nbsp;    @PostMapping(&quot;/DeterministicGenerate&quot;)
&nbsp;    public ResponseEntity challengeDeterministic(
&nbsp;            @Parameter(description = &quot;Challenge ID&quot;, required = true) @RequestParam long chalid,
&nbsp;            @Parameter(description = &quot;Powerup ID to use (non-random)&quot;, required = true) @RequestParam long powerupId,
&nbsp;            @RequestBody Location loc
&nbsp;    ) {
<b class="nc">&nbsp;        return service.generate(chalid, loc, powerupId);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Apply the effect of a collected powerup&quot;,
&nbsp;            description = &quot;&quot;&quot;
&nbsp;                    Determines how the selected powerup affects the player:
&nbsp;                    
&nbsp;                    • Time-based powerups: calculates seconds to subtract based on distance  
&nbsp;                    • General hints: resolves city/county/state  
&nbsp;                    • Specific hints: resolves street name / neighborhood / ZIP  
&nbsp;                    • Other powerups: returns their custom affect text
&nbsp;                    
&nbsp;                    Returns a PowerupEffectDTO containing the effect results.
&nbsp;                    &quot;&quot;&quot;
&nbsp;    )
&nbsp;    @ApiResponses({
&nbsp;            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Powerup effect successfully applied&quot;,
&nbsp;                    content = @Content(schema = @Schema(implementation = PowerupEffectDTO.class))),
&nbsp;            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Powerup or account or challenge not found&quot;),
&nbsp;    })
&nbsp;    @io.swagger.v3.oas.annotations.parameters.RequestBody(
&nbsp;            required = true,
&nbsp;            description = &quot;The player&#39;s current GPS location when picking up the powerup.&quot;,
&nbsp;            content = @Content(
&nbsp;                    schema = @Schema(implementation = Location.class),
&nbsp;                    examples = @ExampleObject(
&nbsp;                            value = &quot;&quot;&quot;
&nbsp;                            {
&nbsp;                              &quot;latitude&quot;: 42.03411,
&nbsp;                              &quot;longitude&quot;: -93.64055
&nbsp;                            }
&nbsp;                            &quot;&quot;&quot;
&nbsp;                    )
&nbsp;            )
&nbsp;    )
&nbsp;    @PostMapping(&quot;/getAffect&quot;)
&nbsp;    public ResponseEntity powerupAffect(
&nbsp;            @Parameter(description = &quot;Powerup ID&quot;) @RequestParam long powerupId,
&nbsp;            @Parameter(description = &quot;Player account ID&quot;) @RequestParam long uid,
&nbsp;            @Parameter(description = &quot;Challenge ID&quot;) @RequestParam long chalid,
&nbsp;            @Parameter(description = &quot;Latitude of the powerup spawned&quot;) @RequestParam double powerupLat,
&nbsp;            @Parameter(description = &quot;Longitude of the powerup spawned&quot;) @RequestParam double powerupLon,
&nbsp;            @RequestBody Location loc) {
&nbsp;
<b class="nc">&nbsp;        return service.deduce(</b>
&nbsp;                powerupId,
&nbsp;                uid,
&nbsp;                chalid,
&nbsp;                loc,
&nbsp;                new Location(powerupLat, powerupLon)
&nbsp;        );
&nbsp;    }
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Add a powerup to a user&#39;s inventory&quot;,
&nbsp;            description = &quot;&quot;&quot;
&nbsp;                Associates a powerup with a specific user account.
&nbsp;                
&nbsp;                This creates a many-to-many relationship entry between:
&nbsp;                • The selected Powerup  
&nbsp;                • The target Account  
&nbsp;                
&nbsp;                Returns 201 if successfully added, or 404 if the powerup or account does not exist.
&nbsp;                &quot;&quot;&quot;
&nbsp;    )
&nbsp;    @ApiResponses(value = {
&nbsp;            @ApiResponse(responseCode = &quot;201&quot;, description = &quot;Powerup successfully added to user&quot;),
&nbsp;            @ApiResponse(responseCode = &quot;404&quot;, description = &quot;Account or powerup not found&quot;, content = @Content),
&nbsp;    })
&nbsp;    @PutMapping(&quot;/add&quot;)
&nbsp;    public ResponseEntity addPowerup(
&nbsp;            @Parameter(description = &quot;ID of the powerup to add&quot;, required = true)
&nbsp;            @RequestParam long powerupId,
&nbsp;
&nbsp;            @Parameter(description = &quot;ID of the user who will receive the powerup&quot;, required = true)
&nbsp;            @RequestParam long uid
&nbsp;    ) {
<b class="nc">&nbsp;        return service.addToAcc(powerupId, uid);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Retrieve all powerups owned by a user&quot;,
&nbsp;            description = &quot;&quot;&quot;
&nbsp;                Returns the full set of powerups associated with a specific user.
&nbsp;                
&nbsp;                Useful for mobile clients to display the player&#39;s inventory or
&nbsp;                determine which powerups they can activate.
&nbsp;                &quot;&quot;&quot;
&nbsp;    )
&nbsp;    @ApiResponses(value = {
&nbsp;            @ApiResponse(responseCode = &quot;200&quot;, description = &quot;Successfully retrieved user&#39;s powerups&quot;,
&nbsp;                    content = @Content(mediaType = &quot;application/json&quot;,
&nbsp;                            schema = @Schema(implementation = Powerup.class))),
&nbsp;            @ApiResponse(responseCode = &quot;500&quot;, description = &quot;Account not found or cannot load powerups&quot;)
&nbsp;    })
&nbsp;    @GetMapping(&quot;/user&quot;)
&nbsp;    public ResponseEntity user(
&nbsp;            @Parameter(description = &quot;ID of the user whose powerups to fetch&quot;, required = true)
&nbsp;            @RequestParam long uid
&nbsp;    ) {
<b class="nc">&nbsp;        return service.getPowerupsForAccount(uid);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Operation(
&nbsp;            summary = &quot;Remove a powerup from a user&#39;s account&quot;,
&nbsp;            description = &quot;&quot;&quot;
&nbsp;                Removes a specific powerup from the given user&#39;s inventory.
&nbsp;                
&nbsp;                This modifies the many-to-many relationship between Accounts and Powerups.
&nbsp;                The user must already own the powerup — otherwise a 404 is returned.
&nbsp;                &quot;&quot;&quot;
&nbsp;    )
&nbsp;    @ApiResponses({
&nbsp;            @ApiResponse(
&nbsp;                    responseCode = &quot;200&quot;,
&nbsp;                    description = &quot;Powerup successfully removed from user&quot;,
&nbsp;                    content = @Content(
&nbsp;                            mediaType = &quot;application/json&quot;,
&nbsp;                            examples = @ExampleObject(
&nbsp;                                    value = &quot;\&quot;Successfully removed powerup from user\&quot;&quot;
&nbsp;                            )
&nbsp;                    )
&nbsp;            ),
&nbsp;            @ApiResponse(
&nbsp;                    responseCode = &quot;404&quot;,
&nbsp;                    description = &quot;Account not found, powerup not found, or user does not own the powerup&quot;,
&nbsp;                    content = @Content(
&nbsp;                            mediaType = &quot;application/json&quot;,
&nbsp;                            examples = @ExampleObject(
&nbsp;                                    value = &quot;\&quot;User does not own this powerup\&quot;&quot;
&nbsp;                            )
&nbsp;                    )
&nbsp;            )
&nbsp;    })
&nbsp;
&nbsp;    @DeleteMapping(&quot;/remove&quot;)
&nbsp;    public ResponseEntity removePowerupForAccount(
&nbsp;            @Parameter(
&nbsp;                    description = &quot;The ID of the user whose inventory should be modified&quot;,
&nbsp;                    required = true
&nbsp;            )
&nbsp;            @RequestParam long uid,
&nbsp;
&nbsp;            @Parameter(
&nbsp;                    description = &quot;The ID of the powerup to be removed from the user&quot;,
&nbsp;                    required = true
&nbsp;            )
&nbsp;            @RequestParam long powerupId
&nbsp;    ) {
<b class="nc">&nbsp;        return service.removePowerupForAccount(uid, powerupId);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-12-09 21:04</div>
</div>
</body>
</html>
